# Biological interpretation of findings
In this chapter we will explain the steps for the biological interpretation of
the findings. A file with the theory
can be downloaded [here](./Theory/ISG_summer_school_EWAS5.pptx)

We will need to load some libraries:
```{r libs_annot, eval=FALSE}
library(clusterProfiler)
library(org.Hs.eg.db)
library(enrichplot)
```


## Annotation of CpG sites
Once we have obtained a list with the CpGs that are significant in our analysis,
we need to locate them in the genome and try to know which structures 
surround them. The annotation consists in obtaining this information:
```{r annot}

```

## Functional enrichment analysis
The idea is to compare the list of genes that overlap our CpGs with the list of 
all the human genes that are anotated in specific databases. With this, we can see
if our list of genes is a random subset or no.

We will work with the Gene Ontology (GO) and the Kyoto Encyclopedia of
Genes and Genomes (KEGG) databases. The GO database allows us to see if a
specific gene function is overrepresented in our gene list. The KEGG database
will show if a specific pathway is overrepresented in our gene list. 

First we need to obtain the list of all human genes that are curated in the databases
```{r genelist, eval=FALSE}
# GO
df = as.data.frame(org.Hs.egGO)
go_gene_list = unique(sort(df$gene_id))

# KEGG
dfk = as.data.frame(org.Hs.egPATH)
kegg_gene_list = unique(sort(dfk$gene_id))
```


And then run the analyses for each one and keep the most interesting results.
```{r results, eval=FALSE}
ans.go <- enrichGO(gene = entrez, ont = "BP",
                   OrgDb ="org.Hs.eg.db",
                   universe = go_gene_list,
                   readable=TRUE,
                   pvalueCutoff = 0.05)

tab.go <- as.data.frame(ans.go)
tab.go<- subset(tab.go, Count>5)

ans.kegg <- enrichKEGG(gene = entrez,
                       organism = 'hsa',
                       universe = kegg_gene_list,
                       pvalueCutoff = 0.05)
tab.kegg <- as.data.frame(ans.kegg)
tab.kegg<- subset(tab.kegg, Count>5)

```

Finally we can perform different type of plots to see the results in a graphical way
```{r plots, eval=FALSE}
p1 <- barplot(ans.go, showCategory=10) + ggtitle('GO - no MCH') + theme(plot.title = element_text(size = 25))
p1
ans.go <- pairwise_termsim(ans.go)
p5 <- emapplot(ans.go) + ggtitle('GO - no MCH') + theme(plot.title = element_text(size = 25))
p5
```

