[{"path":"index.html","id":"introduction-to-epigenome-wide-association-studies-ewas","chapter":"Introduction to Epigenome-Wide Association Studies (EWAS)","heading":"Introduction to Epigenome-Wide Association Studies (EWAS)","text":" Coordinator: Juan Ramon González\n lecturers: Mariona Bustamante, Sofía Aguilar-Lacasaña, Laura Balagué\n Aim: introduce basic concepts guidelines conduct epigenome-wide association studies (EWAS) using DNA methylation data obtained arrays.\n Learning Objectives: Upon successful completion module, participants able conduct:Pre-processing DNA methylation dataEpigenome-wide association studies (EWAS)Meta-analysis EWAS different studiesAnnotation functional interpretation findings\n Additional requirements:Required: Intermediate knowledge R environment.Recommended resources: Laptop computer >8Gb RAMTime Slot 1: 9 11 h CESTTeaching language: English","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"introduction-to-dna-methylation-data-and-bioconductor","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1 Introduction to DNA methylation data and Bioconductor","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"introduction-to-epigenetics","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.1 Introduction to epigenetics","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"brief-introduction-to-epigenetics","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.1.1 Brief introduction to epigenetics","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"dna-methylation-data-acquisition","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.1.2 DNA methylation data acquisition","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"applications-of-epigenetics","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.1.3 Applications of epigenetics","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"epigenetics-among-transitioning-african-populations","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.2 Epigenetics among transitioning African populations","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"resources-and-tools-for-epigenetics","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3 Resources and tools for epigenetics","text":"introduce different resources tools working\nomics data R environment:","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"bioconductor","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3.1 Bioconductor","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"gene-expression-omnibus-geo-repository","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3.2 Gene Expression Omnibus (GEO) repository","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"expressionset-and-genomicratioset","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3.3 ExpressionSet and GenomicRatioSet","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"methylation-related-packages","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3.4 Methylation-related packages","text":"","code":""},{"path":"pre-processing-of-dna-methylation-data.html","id":"pre-processing-of-dna-methylation-data","chapter":"2 Pre-processing of DNA methylation data","heading":"2 Pre-processing of DNA methylation data","text":"chapter explain steps pre-processing \nDNA methylation data meffil R package.","code":""},{"path":"pre-processing-of-dna-methylation-data.html","id":"creation-of-the-sample-sheet","chapter":"2 Pre-processing of DNA methylation data","heading":"2.1 Creation of the Sample Sheet","text":"loading meffil library, need create sample sheet IDAT files.function automatically adds sample name, slide, row, column filename\nIDATs. can remove columns can manually add .\ncase add sex, age smoking status variables. duplicated\nsamples individual, also add individual ID \nremove duplicates.First load phenotype dataAnd add sex, age smoking status variables, keeping \nsamples metadataFinally can save sample sheet","code":"\nlibrary(meffil)\nsamplesheet <- meffil.create.samplesheet(\"H:/analyses/Course_Intro_to_EWAS/db/GSE42861/Raw/G1\", recursive=TRUE)\ndim(samplesheet)## [1] 298   6\npheno <- read.table(\"H:/analyses/Course_Intro_to_EWAS/db/GSE42861/Phenotype/GSE42861_pheno.txt\", sep = '\\t', header = T)\nhead(pheno)\nsamplesheet <- merge(samplesheet[,c('Sample_Name', 'Slide', 'sentrix_row', 'sentrix_col', 'Basename')], \n                     pheno[,c('Sample', 'Age', 'Sex', 'Smoking')], \n                     by.x = 'Sample_Name', \n                     by.y = 'Sample')\nhead(samplesheet)\nsave(samplesheet, file=\"H:/analyses/Course_Intro_to_EWAS/results/QC/SampleSheetG1.Rdata\")"},{"path":"pre-processing-of-dna-methylation-data.html","id":"sample-and-cpg-quality-control","chapter":"2 Pre-processing of DNA methylation data","heading":"2.2 Sample and CpG quality control","text":"sample sheet, first step QC creation \nQC objects. specify cell type reference (idol optimized)\nthresholds detection minimum number beads.RUN STEP CLASS - time consuming.Instead, load QC Objects provide:, setup parameters QCAnd run itTo generate QC report can run:line creates html report several QC tests. need examine \ndetail.next step getting rid samples pass QC. \ncase, looking report, decided maintain samples\noutliers XY ratio.probes pass QC removed afterwards \nnormalisation step.","code":"\n# DO NOT RUN\n\nmeffil.list.cell.type.references()\nqc.objects <- meffil.qc(samplesheet, cell.type.reference=\"blood idoloptimized\", \n                        verbose=TRUE,\n                        detection.threshold = 0.01,\n                        bead.threshold = 3)\nsave(qc.objects, file = 'H:/analyses/Course_Intro_to_EWAS/results/QC/QCObjects.RData')\nload('H:/analyses/Course_Intro_to_EWAS/results/QC/QCObjects.RData')\nqc.parameters <- meffil.qc.parameters(\n  beadnum.samples.threshold             = 0.05,\n  detectionp.samples.threshold          = 0.03,\n  detectionp.cpgs.threshold             = 0.05, \n  beadnum.cpgs.threshold                = 0.05,\n  sex.outlier.sd                        = 3\n)\nqc.summary <- meffil.qc.summary(\n  qc.objects,\n  parameters = qc.parameters,\n  genotypes=NULL,\n  verbose=TRUE\n)\nmeffil.qc.report(qc.summary, output.file=\"H:/analyses/Course_Intro_to_EWAS/results/QC/qc-report_whole.html\")\noutlier <- qc.summary$bad.samples\noutlier <- outlier[outlier$issue!='X-Y ratio outlier',]\noutlier\nqc.objects <- meffil.remove.samples(qc.objects, outlier$sample.name)"},{"path":"pre-processing-of-dna-methylation-data.html","id":"normalisation","chapter":"2 Pre-processing of DNA methylation data","heading":"2.3 Normalisation","text":"First assess number needed PCs help plot:perform functional normalisation indicating number PCs \nIDs bad CpGs QC remove. step recommended check\nmissingness per sample cpgDO RUN STEPS CLASS - time consuming.Instead, load normalisation objects betas provide:Now can create normalisation report. need convert factor \nbatch variables want assess recalculate PCsFinally, obtain normalisation summary report","code":"\ny <- meffil.plot.pc.fit(qc.objects)\ny$plot\n# DO NOT RUN\nnorm.objects <- meffil.normalize.quantiles(qc.objects, number.pcs=15)\n# DO NOT RUN\nnorm.beta <- meffil.normalize.samples(\n  norm.objects,\n  just.beta=T,\n  remove.poor.signal = T,\n  cpglist.remove=qc.summary$bad.cpgs$name,\n  verbose=T)\n\n# missing per sample - DO NOT RUN\nmiss_IDs <- miss_case_summary(data.frame(t(norm.beta)), order = TRUE)\nmiss_IDs$case <- colnames(norm.beta)\ngc(reset=TRUE)\nbad_ids <- miss_IDs[which(miss_IDs$pct_miss>5),]$case\n\n# missing per cpg - DO NOT RUN\nbad_cpgs <- miss_cpgs[which(miss_cpgs$pct_miss>5),]$variable\nlength(bad_cpgs)\n\n# remove - DO NOT RUN\nnorm.beta <- norm.beta[!rownames(norm.beta) %in% bad_cpgs, !colnames(norm.beta) %in% bad_ids]\nnorm.objects <- norm.objects[!names(norm.objects)%in% bad_ids]\ngc(reset=TRUE)\n\nsave(norm.objects, file = \"H:/analyses/Course_Intro_to_EWAS/results/QC/norm_objects15.RData\")\nsave(norm.beta, file = \"H:/analyses/Course_Intro_to_EWAS/results/QC/norm_beta15.Robj\")\nload(\"H:/analyses/Course_Intro_to_EWAS/results/QC/norm_objects15.RData\")\nload(\"H:/analyses/Course_Intro_to_EWAS/results/QC/norm_beta15.Robj\")\nfor (i in 1:length(norm.objects)){\n  norm.objects[[i]]$samplesheet$Slide<-as.factor(norm.objects[[i]]$samplesheet$Slide)\n  norm.objects[[i]]$samplesheet$Sex<-as.factor(norm.objects[[i]]$samplesheet$Sex)\n  norm.objects[[i]]$samplesheet$Age<-as.factor(norm.objects[[i]]$samplesheet$Age)\n  norm.objects[[i]]$samplesheet$Smoking<-as.factor(norm.objects[[i]]$samplesheet$Smoking)\n}\n\nbatch_var<-c(\"Slide\",\"Sex\", \"Age\", \"Smoking\")\n\nnorm.parameters <- meffil.normalization.parameters(\n  norm.objects,\n  variables=batch_var,\n  control.pcs=1:5,\n  batch.pcs=1:5,\n  batch.threshold=0.01\n)\n\npcs <- meffil.methylation.pcs(norm.beta,verbose=T, full.obj = T)\nnorm.summary <- meffil.normalization.summary(norm.objects, pcs$x, parameters=norm.parameters)\nmeffil.normalization.report(norm.summary, output.file=\"H:/analyses/Course_Intro_to_EWAS/results/QC/normalization-report.html\")"},{"path":"pre-processing-of-dna-methylation-data.html","id":"creation-of-a-expression-set","chapter":"2 Pre-processing of DNA methylation data","heading":"2.4 Creation of a Expression Set","text":"","code":""},{"path":"pre-processing-of-dna-methylation-data.html","id":"estimation-of-cell-type-proportions","chapter":"2 Pre-processing of DNA methylation data","heading":"2.4.1 Estimation of cell type proportions","text":"run EWAS, need know cell type proportions. \nautomatically calculated first steps QC can recovered \nsaved way:add information phenotype already ","code":"\ncc<-t(sapply(qc.objects, function(obj) obj$cell.counts$counts))\ncc<-data.frame(PatientID=row.names(cc),cc) \nwrite.table(cc, file = \"H:/analyses/Course_Intro_to_EWAS/results/QC/cellular_composition.txt\", quote = F, row.names = F, sep = '\\t')\nphenoData <- merge(pheno, cc[,2:7], by.x = 'Sample', by.y = 0)\nrownames(phenoData) <- phenoData[,1]\nphenoData <- phenoData[,-1]\nhead(phenoData)"},{"path":"pre-processing-of-dna-methylation-data.html","id":"assembling","chapter":"2 Pre-processing of DNA methylation data","heading":"2.4.2 Assembling","text":"assemble final ExpressionSet first create metadata \nphenotypes, consists dataframe variables description.\ncreate Annotated Dataframe., join matrix normalized betas annotated\ndataframe phenotypes cellular compositions.\nmake sure sample IDs coincide two datasets.saved ExpressionSet normalised betas \nphenotypes ready run EWAS.RUN STEP CLASS - time consuming. \nprovide eSet needed EWAS.","code":"\nlibrary(Biobase)\nmData <- data.frame(labelDescription=c(\"Sample cell type\",\"Patient Age\", \"Patient Sex\", \"Smoking Status (never/current/former)\",\n                                       \"Percentage of B Lymphocytes\", \"Percentage of CD4T Lymphocytes\",\n                                       \"Percentage of CDBT Lymphocytes\", \"Percentage of Monocytes\", \"Percentage of Neutrophils\",\n                                       \"Percentage of Natural Killer\"),\n                    row.names=colnames(phenoData))\n\nphenoData = new(\"AnnotatedDataFrame\", data=phenoData, varMetadata=mData)\nall(colnames(norm.beta) == rownames(phenoData))## [1] TRUE\neSet<-ExpressionSet(assayData=norm.beta,\n                    phenoData=phenoData)\neSet## ExpressionSet (storageMode: lockedEnvironment)\n## assayData: 483153 features, 294 samples \n##   element names: exprs \n## protocolData: none\n## phenoData\n##   sampleNames: GSM1051533 GSM1051534 ... GSM1052213 (294 total)\n##   varLabels: Celltype Age ... NK (10 total)\n##   varMetadata: labelDescription\n## featureData: none\n## experimentData: use 'experimentData(object)'\n## Annotation:\n# DO NOT RUN\nsaveRDS(eSet, 'H:/analyses/Course_Intro_to_EWAS/results/QC/GSE42861_full_norm.Rds')"},{"path":"epigenome-wide-association-study-ewas.html","id":"epigenome-wide-association-study-ewas","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3 Epigenome-wide association study (EWAS)","text":"explain conduct EWAS:","code":""},{"path":"epigenome-wide-association-study-ewas.html","id":"statistical-methods","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.1 Statistical methods","text":"","code":""},{"path":"epigenome-wide-association-study-ewas.html","id":"visualisation-of-results-qq-plot-manhattan-volcano","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.2 Visualisation of results: QQ-plot, Manhattan, Volcano","text":"","code":""},{"path":"meta-analysis-of-epigenome-wide-association-studies-metaewas.html","id":"meta-analysis-of-epigenome-wide-association-studies-metaewas","chapter":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","heading":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","text":"explain conduct metaEWAS:","code":""},{"path":"meta-analysis-of-epigenome-wide-association-studies-metaewas.html","id":"quality-control-of-results-from-different-studies","chapter":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","heading":"4.1 Quality control of results from different studies","text":"","code":""},{"path":"meta-analysis-of-epigenome-wide-association-studies-metaewas.html","id":"statistical-methods-to-combine-results-from-different-studies","chapter":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","heading":"4.2 Statistical methods to combine results from different studies","text":"","code":""},{"path":"meta-analysis-of-epigenome-wide-association-studies-metaewas.html","id":"visualization-of-results-qq-plot-manhattan-volcano","chapter":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","heading":"4.3 Visualization of results: QQ-plot, Manhattan, Volcano","text":"","code":""},{"path":"biological-interpretation-of-findings.html","id":"biological-interpretation-of-findings","chapter":"5 Biological interpretation of findings","heading":"5 Biological interpretation of findings","text":"explain steps biological interpretation findings:","code":""},{"path":"biological-interpretation-of-findings.html","id":"annotation-of-cpg-sites","chapter":"5 Biological interpretation of findings","heading":"5.1 Annotation of CpG sites","text":"","code":""},{"path":"biological-interpretation-of-findings.html","id":"functional-enrichment-analysis","chapter":"5 Biological interpretation of findings","heading":"5.2 Functional enrichment analysis","text":"","code":""},{"path":"biological-interpretation-of-findings.html","id":"comparison-with-ewas-atlas-and-ewas-catalog","chapter":"5 Biological interpretation of findings","heading":"5.3 Comparison with EWAS Atlas and EWAS Catalog","text":"","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
