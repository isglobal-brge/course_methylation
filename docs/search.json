[{"path":"index.html","id":"introduction-to-epigenome-wide-association-studies-ewas","chapter":"Introduction to Epigenome-Wide Association Studies (EWAS)","heading":"Introduction to Epigenome-Wide Association Studies (EWAS)","text":" Coordinator: Juan Ramon González\n lecturers: Mariona Bustamante, Sofía Aguilar-Lacasaña, Laura Balagué\n Aim: introduce basic concepts guidelines conduct epigenome-wide association studies (EWAS) using DNA methylation data obtained arrays.\n Learning Objectives: Upon successful completion module, participants able conduct:Pre-processing DNA methylation dataEpigenome-wide association studies (EWAS)Meta-analysis EWAS different studiesAnnotation functional interpretation findings\n Additional requirements:Required: Intermediate knowledge R environment.Recommended resources: Laptop computer >8Gb RAMTime Slot 1: 9 11 h CESTTeaching language: English","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"introduction-to-dna-methylation-data-and-bioconductor","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1 Introduction to DNA methylation data and Bioconductor","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"introduction-to-epigenetics","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.1 Introduction to epigenetics","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"brief-introduction-to-epigenetics","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.1.1 Brief introduction to epigenetics","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"dna-methylation-data-acquisition","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.1.2 DNA methylation data acquisition","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"applications-of-epigenetics","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.1.3 Applications of epigenetics","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"epigenetics-among-transitioning-african-populations","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.2 Epigenetics among transitioning African populations","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"resources-and-tools-for-epigenetics","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3 Resources and tools for epigenetics","text":"introduce different resources tools working\nomics data R environment:","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"bioconductor","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3.1 Bioconductor","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"gene-expression-omnibus-geo-repository","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3.2 Gene Expression Omnibus (GEO) repository","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"expressionset-and-genomicratioset","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3.3 ExpressionSet and GenomicRatioSet","text":"","code":""},{"path":"introduction-to-dna-methylation-data-and-bioconductor.html","id":"methylation-related-packages","chapter":"1 Introduction to DNA methylation data and Bioconductor","heading":"1.3.4 Methylation-related packages","text":"","code":""},{"path":"pre-processing-of-dna-methylation-data.html","id":"pre-processing-of-dna-methylation-data","chapter":"2 Pre-processing of DNA methylation data","heading":"2 Pre-processing of DNA methylation data","text":"chapter explain steps pre-processing \nDNA methylation data meffil R package.","code":""},{"path":"pre-processing-of-dna-methylation-data.html","id":"creation-of-the-sample-sheet","chapter":"2 Pre-processing of DNA methylation data","heading":"2.1 Creation of the Sample Sheet","text":"loading meffil library, need create sample sheet IDAT files.function automatically adds sample name, slide, row, column filename\nIDATs. can remove columns can manually add .\ncase add sex, age smoking status variables. duplicated\nsamples individual, also add individual ID \nremove duplicates.First load phenotype dataAnd add sex, age smoking status variables, keeping \nsamples metadataFinally can save sample sheet","code":"\nlibrary(meffil)\nsamplesheet <- meffil.create.samplesheet(\"H:/analyses/Course_Intro_to_EWAS/db/GSE42861/Raw/G1\", recursive=TRUE)\ndim(samplesheet)## [1] 298   6\npheno <- read.table(\"H:/analyses/Course_Intro_to_EWAS/db/GSE42861/Phenotype/GSE42861_pheno.txt\", sep = '\\t', header = T)\nhead(pheno)\nsamplesheet <- merge(samplesheet[,c('Sample_Name', 'Slide', 'sentrix_row', 'sentrix_col', 'Basename')], \n                     pheno[,c('Sample', 'Age', 'Sex', 'Smoking')], \n                     by.x = 'Sample_Name', \n                     by.y = 'Sample')\nhead(samplesheet)\nsave(samplesheet, file=\"H:/analyses/Course_Intro_to_EWAS/results/QC/SampleSheetG1.Rdata\")"},{"path":"pre-processing-of-dna-methylation-data.html","id":"sample-and-cpg-quality-control","chapter":"2 Pre-processing of DNA methylation data","heading":"2.2 Sample and CpG quality control","text":"sample sheet, first step QC creation \nQC objects. specify cell type reference (idol optimized)\nthresholds detection minimum number beads.RUN STEP CLASS - time consuming.Instead, load QC Objects provide:, setup parameters QCAnd run itTo generate QC report can run:line creates html report several QC tests. need examine \ndetail.next step getting rid samples pass QC. \ncase, looking report, decided maintain samples\noutliers XY ratio.probes pass QC removed afterwards \nnormalisation step.","code":"\n# DO NOT RUN\n\nmeffil.list.cell.type.references()\nqc.objects <- meffil.qc(samplesheet, cell.type.reference=\"blood idoloptimized\", \n                        verbose=TRUE,\n                        detection.threshold = 0.01,\n                        bead.threshold = 3)\nsave(qc.objects, file = 'H:/analyses/Course_Intro_to_EWAS/results/QC/QCObjects.RData')\nload('H:/analyses/Course_Intro_to_EWAS/results/QC/QCObjects.RData')\nqc.parameters <- meffil.qc.parameters(\n  beadnum.samples.threshold             = 0.05,\n  detectionp.samples.threshold          = 0.03,\n  detectionp.cpgs.threshold             = 0.05, \n  beadnum.cpgs.threshold                = 0.05,\n  sex.outlier.sd                        = 3\n)\nqc.summary <- meffil.qc.summary(\n  qc.objects,\n  parameters = qc.parameters,\n  genotypes=NULL,\n  verbose=TRUE\n)\nmeffil.qc.report(qc.summary, output.file=\"H:/analyses/Course_Intro_to_EWAS/results/QC/qc-report_whole.html\")\noutlier <- qc.summary$bad.samples\noutlier <- outlier[outlier$issue!='X-Y ratio outlier',]\noutlier\nqc.objects <- meffil.remove.samples(qc.objects, outlier$sample.name)"},{"path":"pre-processing-of-dna-methylation-data.html","id":"normalisation","chapter":"2 Pre-processing of DNA methylation data","heading":"2.3 Normalisation","text":"First assess number needed PCs help plot:perform functional normalisation indicating number PCs \nIDs bad CpGs QC remove. step recommended check\nmissingness per sample cpgDO RUN STEPS CLASS - time consuming.Instead, load normalisation objects betas provide:Now can create normalisation report. need convert factor \nbatch variables want assess recalculate PCsFinally, obtain normalisation summary report","code":"\ny <- meffil.plot.pc.fit(qc.objects)\ny$plot\n# DO NOT RUN\nnorm.objects <- meffil.normalize.quantiles(qc.objects, number.pcs=15)\n# DO NOT RUN\nnorm.beta <- meffil.normalize.samples(\n  norm.objects,\n  just.beta=T,\n  remove.poor.signal = T,\n  cpglist.remove=qc.summary$bad.cpgs$name,\n  verbose=T)\n\n# missing per sample - DO NOT RUN\nmiss_IDs <- miss_case_summary(data.frame(t(norm.beta)), order = TRUE)\nmiss_IDs$case <- colnames(norm.beta)\ngc(reset=TRUE)\nbad_ids <- miss_IDs[which(miss_IDs$pct_miss>5),]$case\n\n# missing per cpg - DO NOT RUN\nbad_cpgs <- miss_cpgs[which(miss_cpgs$pct_miss>5),]$variable\nlength(bad_cpgs)\n\n# remove - DO NOT RUN\nnorm.beta <- norm.beta[!rownames(norm.beta) %in% bad_cpgs, !colnames(norm.beta) %in% bad_ids]\nnorm.objects <- norm.objects[!names(norm.objects)%in% bad_ids]\ngc(reset=TRUE)\n\nsave(norm.objects, file = \"H:/analyses/Course_Intro_to_EWAS/results/QC/norm_objects15.RData\")\nsave(norm.beta, file = \"H:/analyses/Course_Intro_to_EWAS/results/QC/norm_beta15.Robj\")\nload(\"H:/analyses/Course_Intro_to_EWAS/results/QC/norm_objects15.RData\")\nload(\"H:/analyses/Course_Intro_to_EWAS/results/QC/norm_beta15.Robj\")\nfor (i in 1:length(norm.objects)){\n  norm.objects[[i]]$samplesheet$Slide<-as.factor(norm.objects[[i]]$samplesheet$Slide)\n  norm.objects[[i]]$samplesheet$Sex<-as.factor(norm.objects[[i]]$samplesheet$Sex)\n  norm.objects[[i]]$samplesheet$Age<-as.factor(norm.objects[[i]]$samplesheet$Age)\n  norm.objects[[i]]$samplesheet$Smoking<-as.factor(norm.objects[[i]]$samplesheet$Smoking)\n}\n\nbatch_var<-c(\"Slide\",\"Sex\", \"Age\", \"Smoking\")\n\nnorm.parameters <- meffil.normalization.parameters(\n  norm.objects,\n  variables=batch_var,\n  control.pcs=1:5,\n  batch.pcs=1:5,\n  batch.threshold=0.01\n)\n\npcs <- meffil.methylation.pcs(norm.beta,verbose=T, full.obj = T)\nnorm.summary <- meffil.normalization.summary(norm.objects, pcs$x, parameters=norm.parameters)\nmeffil.normalization.report(norm.summary, output.file=\"H:/analyses/Course_Intro_to_EWAS/results/QC/normalization-report.html\")"},{"path":"pre-processing-of-dna-methylation-data.html","id":"creation-of-a-expression-set","chapter":"2 Pre-processing of DNA methylation data","heading":"2.4 Creation of a Expression Set","text":"","code":""},{"path":"pre-processing-of-dna-methylation-data.html","id":"estimation-of-cell-type-proportions","chapter":"2 Pre-processing of DNA methylation data","heading":"2.4.1 Estimation of cell type proportions","text":"run EWAS, need know cell type proportions. \nautomatically calculated first steps QC can recovered \nsaved way:add information phenotype already ","code":"\ncc<-t(sapply(qc.objects, function(obj) obj$cell.counts$counts))\ncc<-data.frame(PatientID=row.names(cc),cc) \nwrite.table(cc, file = \"H:/analyses/Course_Intro_to_EWAS/results/QC/cellular_composition.txt\", quote = F, row.names = F, sep = '\\t')\nphenoData <- merge(pheno, cc[,2:7], by.x = 'Sample', by.y = 0)\nrownames(phenoData) <- phenoData[,1]\nphenoData <- phenoData[,-1]\nhead(phenoData)"},{"path":"pre-processing-of-dna-methylation-data.html","id":"assembling","chapter":"2 Pre-processing of DNA methylation data","heading":"2.4.2 Assembling","text":"assemble final ExpressionSet first create metadata \nphenotypes, consists dataframe variables description.\ncreate Annotated Dataframe., join matrix normalized betas annotated\ndataframe phenotypes cellular compositions.\nmake sure sample IDs coincide two datasets.saved ExpressionSet normalised betas \nphenotypes ready run EWAS.RUN STEP CLASS - time consuming. \nprovide eSet needed EWAS.","code":"\nlibrary(Biobase)\nmData <- data.frame(labelDescription=c(\"Sample cell type\",\"Patient Age\", \"Patient Sex\", \"Smoking Status (never/current/former)\",\n                                       \"Percentage of B Lymphocytes\", \"Percentage of CD4T Lymphocytes\",\n                                       \"Percentage of CDBT Lymphocytes\", \"Percentage of Monocytes\", \"Percentage of Neutrophils\",\n                                       \"Percentage of Natural Killer\"),\n                    row.names=colnames(phenoData))\n\nphenoData = new(\"AnnotatedDataFrame\", data=phenoData, varMetadata=mData)\nall(colnames(norm.beta) == rownames(phenoData))## [1] TRUE\neSet<-ExpressionSet(assayData=norm.beta,\n                    phenoData=phenoData)\neSet## ExpressionSet (storageMode: lockedEnvironment)\n## assayData: 483153 features, 294 samples \n##   element names: exprs \n## protocolData: none\n## phenoData\n##   sampleNames: GSM1051533 GSM1051534 ... GSM1052213 (294 total)\n##   varLabels: Celltype Age ... NK (10 total)\n##   varMetadata: labelDescription\n## featureData: none\n## experimentData: use 'experimentData(object)'\n## Annotation:\n# DO NOT RUN\nsaveRDS(eSet, 'H:/analyses/Course_Intro_to_EWAS/results/QC/GSE42861_full_norm.Rds')"},{"path":"epigenome-wide-association-study-ewas.html","id":"epigenome-wide-association-study-ewas","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3 Epigenome-wide association study (EWAS)","text":"chapter run Epigenome-wide association study (EWAS)","code":""},{"path":"epigenome-wide-association-study-ewas.html","id":"install-and-load-packages","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.1 Install and load packages","text":"","code":"\nif (!require(\"BiocManager\", quietly = TRUE))\n  install.packages(\"BiocManager\")\n\nBiocManager::install(\"Biobase\")\nBiocManager::install(\"GenomicRanges\")\nBiocManager::install(\"karyoploteR\")\n\ninstall.packages(\"devtools\")\ndevtools::install_github(\"perishky/meffil\")\ninstall.packages(c(\"qqman\",\"ggplot2\",\"ggrepel\"))\nlibrary(Biobase)# to be able to access and modify data in the ExpressionSet\nlibrary(meffil) # to run the EWAS\nlibrary(qqman) # to get QQ plots\nlibrary(ggplot2)# plots\nlibrary(ggrepel)\nlibrary(GenomicRanges) # prepare db for Manhattan plot\nlibrary(karyoploteR)"},{"path":"epigenome-wide-association-study-ewas.html","id":"load-dataset-and-extract-the-phenotypes-and-methylation-matrix","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.2 Load dataset and extract the phenotypes and methylation matrix","text":"","code":"\neset.cohort1<-readRDS(\"H:/analyses/Course_Intro_to_EWAS/results/QC/subsets/GSE42861_norm_cohort1.Rds\") \n\npheno.cohort1<-pData(eset.cohort1)\ndim(pheno.cohort1)## [1] 294  10\nhead(pheno.cohort1)\nmethyl.cohort1<-exprs(eset.cohort1)\ndim(methyl.cohort1) ## [1] 37842   294\nmethyl.cohort1[1:5,1:5]##            GSM1051533 GSM1051534 GSM1051536 GSM1051537 GSM1051538\n## cg02432075 0.09914671 0.05285574 0.11479000 0.09238820 0.05655322\n## cg03515901 0.90775178 0.91091962 0.91043927 0.89217759 0.91384704\n## cg04023335 0.64876572 0.53111687 0.57309345 0.37877619 0.59618924\n## cg08455548 0.07235159 0.07022040 0.09489939 0.08827584 0.06616870\n## cg00006815 0.04753770 0.05215979 0.04847625 0.06924370 0.03970845"},{"path":"epigenome-wide-association-study-ewas.html","id":"run-ewas","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.3 Run EWAS","text":"","code":""},{"path":"epigenome-wide-association-study-ewas.html","id":"option-1-never-vs-current","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.3.1 OPTION 1: Never vs Current","text":"","code":""},{"path":"epigenome-wide-association-study-ewas.html","id":"data-preparation","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.3.1.1 Data preparation","text":"Subset eset never vs current smokers Cohort1Extract methylationExtract phenodata never current smokersCheck levels. want “never” reference levelSelect exposure variableSelect covariates interest EWAS. interested sex, age\ncell type proportionsCheck order samples pheno mehtylation matrix.","code":"\ncurrent <- pheno.cohort1[pheno.cohort1$Smoking %in% c('never','current'),] #subset the phenodata to individuals that never or current smoke\ndim(current)## [1] 188  10\neset.current <- eset.cohort1[,rownames(current)] #subset the eset\neset.current## ExpressionSet (storageMode: lockedEnvironment)\n## assayData: 37842 features, 188 samples \n##   element names: exprs \n## protocolData: none\n## phenoData\n##   sampleNames: GSM1051533 GSM1051534 ... GSM1052213 (188 total)\n##   varLabels: Celltype Age ... NK (10 total)\n##   varMetadata: labelDescription\n## featureData: none\n## experimentData: use 'experimentData(object)'\n## Annotation:\nmethyl.current<-exprs(eset.current)\npheno.current<-pData(eset.current)\npheno.current$Smoking<-as.character(pheno.current$Smoking)\npheno.current$Smoking<-as.factor(pheno.current$Smoking)\nlevels(pheno.current$Smoking)## [1] \"current\" \"never\"\npheno.current$Smoking <- relevel(pheno.current$Smoking, \"never\")\nlevels(pheno.current$Smoking)## [1] \"never\"   \"current\"\nvariable <- pheno.current$Smoking\nclass(variable)## [1] \"factor\"\nclass(pheno.current$Age)## [1] \"integer\"\nclass(pheno.current$Sex)## [1] \"character\"\nclass(pheno.current$Bcell)## [1] \"numeric\"\nclass(pheno.current$CD4T)## [1] \"numeric\"\nclass(pheno.current$CD8T)## [1] \"numeric\"\nclass(pheno.current$Mono)## [1] \"numeric\"\nclass(pheno.current$Neu)## [1] \"numeric\"\nclass(pheno.current$NK)## [1] \"numeric\"\npheno.current$Sex<-as.factor(pheno.current$Sex)\ncovariates <- pheno.current[,c(\"Age\",\"Sex\",\"Bcell\",\"CD4T\",\"CD8T\",\"Mono\",\"Neu\",\"NK\")]\ntable(ifelse(rownames(pheno.current)==colnames(methyl.current),\"Matched\",\"--NOT MATCHED--\"))## \n## Matched \n##     188"},{"path":"epigenome-wide-association-study-ewas.html","id":"ewas","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.3.1.2 EWAS","text":"run EWAS use function meffil.ewas meffil R package. need arguments:Methylattion matrixvector exposure variablesA vector name covariables want includeAs want run robust linear regression model, need specify “TRUE” argument “rlm”reduce impact severe outliers DNA methylation data, winsorize methylation beta values (1%), 0.5% upper lower ends distribution (Ghosh & Vogt, 2012)SVA variables. Argument sva (default TRUE). function calculate surrogate variables adjust model.","code":"\newas.current <- meffil.ewas(methyl.current,\n                            variable=variable,\n                            covariates=covariates,\n                            rlm=TRUE,\n                            winsorize.pct=0.05)## Number of significant surrogate variables is:  31 \n## Iteration (out of 5 ):1  2  3  4  5"},{"path":"epigenome-wide-association-study-ewas.html","id":"results","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.3.1.3 Results","text":"obtain object different informationWe interested EWAS results. function calculated results without adjusted covariates, adjusted covariates specified \nalso adjusted surrogate variables correct batch (noise)use results analysis adjusted SVACreate column Probe ID, rows results dataframeWe order results p.valueThe column names stand :\n- p.value: pval significance association\n- fdr: p.value corrected FALSE DISCOVERY RATE method\n- p.holm: going use. p.value corrected Holm-Bonferroni method\n- “t.statistic”\n- coefficient: coefficient association. case . effect beta\n- coefficient.ci.high: confidence interval \n- coefficient.ci.low: confindence interval \n- coefficient.se: standard error coefficient\n- n: sample size included analysis\n- chromosome\n- position: position CpG genome (hg19)can save results","code":"\nsummary(ewas.current)##                    Length Class           Mode     \n## class                   1 -none-          character\n## version                 1 package_version list     \n## samples               188 -none-          character\n## variable              188 factor          numeric  \n## covariates              8 data.frame      list     \n## winsorize.pct           1 -none-          numeric  \n## batch                   0 -none-          NULL     \n## robust                  1 -none-          logical  \n## rlm                     1 -none-          logical  \n## weights                 0 -none-          NULL     \n## outlier.iqr.factor      1 -none-          logical  \n## most.variable           1 -none-          numeric  \n## p.value            113526 -none-          numeric  \n## coefficient        113526 -none-          numeric  \n## analyses                3 -none-          list     \n## random.seed             1 -none-          numeric  \n## sva.ret                 4 -none-          list\nsummary(ewas.current$analyses)##      Length Class  Mode\n## none 5      -none- list\n## all  5      -none- list\n## sva  5      -none- list\nres.current<-ewas.current$analyses$sva\nres.current<-res.current$table\nres.current$probeID<-rownames(res.current)\nres.current.ord<-res.current[order(res.current$p.value),]\nhead(res.current.ord)\ncolnames(res.current.ord)##  [1] \"p.value\"             \"fdr\"                 \"p.holm\"              \"t.statistic\"         \"coefficient\"        \n##  [6] \"coefficient.ci.high\" \"coefficient.ci.low\"  \"coefficient.se\"      \"n\"                   \"chromosome\"         \n## [11] \"position\"            \"probeID\"\nwrite.table(res.current.ord,\n            \"H:/analyses/Course_Intro_to_EWAS/results/Results.EWAS.cohort1.NeverVScurrent.txt\",\n            sep=\",\")"},{"path":"epigenome-wide-association-study-ewas.html","id":"report","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.3.1.4 Report","text":"report need specify CpGs interested . Today\nselect “cg05575921” annotated AHRR gene well known\nassociation tabbacco.","code":"\newas.parameters <- meffil.ewas.parameters(max.plots = 1,model=\"sva\") #by default uses pval/ number of tests\ncandidate.site <- c(\"cg05575921\")\newas.summary <- meffil.ewas.summary(ewas.current,\n                                    methyl.current,\n                                    selected.cpg.sites=candidate.site,\n                                    parameters=ewas.parameters)                             \nmeffil.ewas.report(ewas.summary, output.file=\"H:/analyses/Course_Intro_to_EWAS/results/EWAS.results/Reports/Report.EWAS.cohort1.NeverVScurrent.html\")"},{"path":"epigenome-wide-association-study-ewas.html","id":"plots","chapter":"3 Epigenome-wide association study (EWAS)","heading":"3.3.1.5 Plots","text":"Lambda QQplotVolcano plot","code":"\npvals.current<-res.current.ord$p.value\nqq(pvals.current,main=(\"QQPlot EWAS cohort 1 smoking Never VS Current\")) \nres.current.sig<-res.current.ord[res.current.ord$fdr < 0.05,]\ndim(res.current.sig)## [1] 289  12\nhead(res.current.sig)\ndim(res.current.sig[res.current.sig$coefficient <0,]) ## [1] 164  12\ndim(res.current.sig[res.current.sig$coefficient >0,]) ## [1] 125  12\nhead(res.current.ord)\nres.current.ord$diffexpressed <- \"NO\"\nres.current.ord$diffexpressed[res.current.ord$coefficient > 0 & res.current.ord$fdr <0.05] <- \"POSITIVE\"\nres.current.ord$diffexpressed[res.current.ord$coefficient < 0 & res.current.ord$fdr <0.05] <- \"NEGATIVE\"\n\np <- ggplot(data=res.current.ord, aes(x=res.current.ord$coefficient, y=-log10(res.current.ord$p.value), col=res.current.ord$diffexpressed)) +\n  xlim(c(-0.3,0.3))+ ylim(c(0,35)) + \n  geom_point(size = 2) + theme_minimal() +\n  labs(title = \" \", x = \"beta\", y = \"-log10(P-value)\", colour = \"Effect\") + \n  theme(axis.title = element_text(size = 14, color = \"black\",vjust=0.5)) + \n  theme(plot.title = element_text(size = 14,face=\"bold\",color=\"black\", hjust= 0.5, vjust=0.5)) + \n  theme(legend.title = element_text(color = \"black\", size = 14))\n\n\n# Add lines as before...\np2 <- p + geom_hline(yintercept=c(-log10(3.8e-04)), col=c(\"red\"),linetype = \"dashed\") + \n  theme(axis.text = element_text(size = 14))\nmycolors<-c(\"#157F8D\",\"#AF8D9B\", \"grey\")\nnames(mycolors) <- c(\"POSITIVE\", \"NEGATIVE\", \"NO\")\n\np3 <- p2 + scale_colour_manual(values = mycolors)\n\np3\n# Create a dataframe with chr, start, end and pval\ndf.current<-res.current.ord[,c(\"chromosome\",\"position\",\"p.value\")]\nhead(df.current)\ndf.current$start<-df.current$position \ndf.current$end<-df.current$position + 1\ncolnames(df.current)<-c(\"chr\",\"position\",\"p.value\",\"start\",\"end\")\ndf.current<-df.current[,c(\"chr\",\"start\",\"end\",\"p.value\")]\n\n# Create GRanges object needed \ndf.GRanges<-makeGRangesFromDataFrame(df.current)\n\nkp <- plotKaryotype(plot.type=4, labels.plotter = NULL)\nkp <- kpAddChromosomeNames(kp, cex=0.6, srt=45)\nkp <- kpPlotManhattan(kp, data=df.GRanges,pval=df.current$p.value, ymax=40,genomewideline =3.42)\nkp <- kpAxis(kp, ymin=0, ymax=40, cex=0.7)"},{"path":"meta-analysis-of-epigenome-wide-association-studies-metaewas.html","id":"meta-analysis-of-epigenome-wide-association-studies-metaewas","chapter":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","heading":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","text":"explain conduct metaEWAS:","code":""},{"path":"meta-analysis-of-epigenome-wide-association-studies-metaewas.html","id":"quality-control-of-results-from-different-studies","chapter":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","heading":"4.1 Quality control of results from different studies","text":"","code":""},{"path":"meta-analysis-of-epigenome-wide-association-studies-metaewas.html","id":"statistical-methods-to-combine-results-from-different-studies","chapter":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","heading":"4.2 Statistical methods to combine results from different studies","text":"","code":""},{"path":"meta-analysis-of-epigenome-wide-association-studies-metaewas.html","id":"visualization-of-results-qq-plot-manhattan-volcano","chapter":"4 Meta-analysis of epigenome-wide association studies (metaEWAS)","heading":"4.3 Visualization of results: QQ-plot, Manhattan, Volcano","text":"","code":""},{"path":"biological-interpretation-of-findings.html","id":"biological-interpretation-of-findings","chapter":"5 Biological interpretation of findings","heading":"5 Biological interpretation of findings","text":"explain steps biological interpretation findings:","code":""},{"path":"biological-interpretation-of-findings.html","id":"annotation-of-cpg-sites","chapter":"5 Biological interpretation of findings","heading":"5.1 Annotation of CpG sites","text":"","code":""},{"path":"biological-interpretation-of-findings.html","id":"functional-enrichment-analysis","chapter":"5 Biological interpretation of findings","heading":"5.2 Functional enrichment analysis","text":"","code":""},{"path":"biological-interpretation-of-findings.html","id":"comparison-with-ewas-atlas-and-ewas-catalog","chapter":"5 Biological interpretation of findings","heading":"5.3 Comparison with EWAS Atlas and EWAS Catalog","text":"","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
